<app-navbar />
<div class="container">
  <form>
    <!-- Sboms -->
    <div class="file-container">
      <div class="table-row" *ngFor="let item of GetLoadingFiles()">
        <div class="item-container">
          <app-spinner></app-spinner>
          <div class="file-name">{{ getAlias(item) }}</div>
          <span class="material-symbols-outlined">edit</span>
          <span class="material-symbols-outlined" (click)="RemoveFile(item)">delete</span>
        </div>
      </div>
      <div class="table-row" *ngFor="let item of GetFiles() | keyvalue">
        <div class="item-container">
          <input type="checkbox" [value]="item.key" (change)="check($event)" [checked]="selectedFiles.indexOf(item.key) !== -1" />
          <div class="file-name">
            <span class="file-name-text" [ngbTooltip]="item.value === null ? 'SBOM is not valid!' : null" [style.color]="item.value === null ? 'red' : 'inherit'">
              {{ getAlias(item.key) }}
            </span>
          </div>
          <span class="material-symbols-outlined">edit</span>
          <span class="material-symbols-outlined" (click)="selectedFile = item.key; open(deleteone)" placement="bottom">delete</span>
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="buttons">
      <app-button
        [text]="(areAllSelected() ? 'DESELECT' : 'SELECT') + ' ALL'"
        (click)="selectAll()"
      ></app-button>
      <app-button text="DELETE SELECTED" (click)="open(deletemany)"></app-button>
      <app-button text="UPLOAD SBOM FILES" (click)="browse()"></app-button>
      <app-button text="CREATE SBOM FROM PROJECT"></app-button>
    </div>
  </form>
  <!-- Popup Modals -->
  <ng-template #deletemany let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">
        Delete the following SBOMS?
      </h4>
    </div>
    <div class="modal-body">
      <div *ngFor="let file of selectedFiles">{{ file }}</div>
    </div>
    <div class="modal-footer">
      <app-button
        text="DELETE"
        aria-label="Delete"
        (click)="delete(); modal.dismiss()"
      ></app-button>
      <app-button
        text="CLOSE"
        aria-label="Close"
        (click)="modal.dismiss()"
      ></app-button>
    </div>
  </ng-template>

  <ng-template #deleteone let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">
        Delete {{ selectedFile }}?
      </h4>
    </div>
    <div class="modal-footer">
      <app-button
        text="DELETE"
        aria-label="Delete"
        (click)="RemoveFile(selectedFile); modal.dismiss()"
      ></app-button>
      <app-button
        text="CLOSE"
        aria-label="Close"
        (click)="modal.dismiss()"
      ></app-button>
    </div>
  </ng-template>
</div>