<div *ngIf="qa" class="wrapper">
  <!-- Body -->
  <section class="body">
    <!-- Components -->
    <div class="components scroll-y">
      <ng-container *ngFor="let component of components | keyvalue">
        <app-accordion>
          <div title>{{ component.key }}</div>
          <div body class="scroll-y component">
            <!-- Tests -->
            <ng-container *ngFor="let test of component.value">
              <!-- Test results -->
              <ng-container
                *ngFor="let testResult of getTestResults(component.key, test)"
              >
                <app-accordion *ngIf="isFiltered(testResult)">
                  <div title class="test-result">
                    <span>{{ testResult.message }}</span>
                  </div>
                  <div extra class="attributes">
                    <div
                      class="circle"
                      *ngFor="let tag of testResult.attributes"
                      [ngStyle]="{ 'background-color': attributes[tag].color }"
                      [ngbTooltip]="tag"
                      placement="top"
                    ></div>
                  </div>
                  <span body>{{ testResult.details }}</span>
                </app-accordion>
              </ng-container>
            </ng-container>
          </div>
        </app-accordion>
      </ng-container>
    </div>
    <!-- Filters -->
    <div class="filters">
      <div class="title">
        Shown Tests
        <span
          class="material-symbols-outlined"
          (click)="accessibilityModal = true"
        >
          <span class="material-symbols-outlined">
            settings_accessibility
          </span></span
        >
      </div>
      <app-circle-toggle
        *ngFor="let attribute of attributes | keyvalue"
        [color]="attribute.value.color"
        [toggle]="attribute.value.shown"
        (click)="attribute.value.shown = !attribute.value.shown"
        >{{ attribute.key }}</app-circle-toggle
      >
    </div>
  </section>
</div>

<app-modal [opened]="accessibilityModal" (close)="accessibilityModal = false">
  <div title>Accessibility Settings</div>
  <div content class="palettes">
    <div>Test Color Palette:</div>
    <div *ngFor="let palette of palettes | keyvalue">
      <input
        type="radio"
        [value]="palette.key"
        (click)="selectedPalette = palette.key"
        [checked]="selectedPalette === palette.key"
      />{{ palette.key | titlecase }}
    </div>
  </div>
  <div actions style="display: flex; gap: 15px">
    <div
      class="btn-modal button flex center hover"
      (click)="accessibilityModal = false"
    >
      <span (click)="setColor()">done</span>
    </div>
  </div>
</app-modal>
